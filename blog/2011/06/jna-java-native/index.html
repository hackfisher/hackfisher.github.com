
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>JNA, Java Nativeå¼€å‘åˆ©å™¨</title>
    
    <meta name="author" content="HackFisher">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->
  </head>

  <body>
    <div class="container">
		<header>
			<h1><a href="/">HackFisher</a>  <small>Stay foolish, Stay hungry</small></h1>
		</header>
		<div class="navbar">
		  <div class="container">
		      <ul class="nav">
		        
		        
		        


  
    
      
      	
      	<li><a href="/about.html">About</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  
    
      
      	
      	<li><a href="/projects.html">Project</a></li>
      	
      
    
  
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  



		      </ul>
		      <form action="http://google.com/search" method="get" class="nav">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:hackfisher.info">
    <input class="search" type="text" name="q" results="0" placeholder="Search">
  </fieldset>
</form>

<ul class="subscription nav" data-subscription="rss">
  <li><a href="/rss.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li> 
</ul>
		    </div>
		</div>
		  <div class="content">
		    
<div class="page-header">
  <h2>JNA, Java Nativeå¼€å‘åˆ©å™¨ </h2>
</div>

<div class="row">
  <div class="span8">
    ç®€å•çš„æ¥è¯´ï¼Œè¿™ç¯‡æ–‡ç« å°±æ˜¯ä»‹ç»ä¸€ä¸ªååˆ†å¥½ç”¨çš„Java Nativeå¼€å‘å·¥å…·, JNAã€‚

åœ¨Javaç¼–ç¨‹ä¸­ï¼Œå¤§éƒ¨åˆ†æ—¶é—´éƒ½ä¸éœ€è¦ç†ä¼šJNIï¼Œä½†æ˜¯å½“ä½ éœ€è¦è°ƒç”¨ä¸€ä¸ªæœ¬åœ°çš„C/C++åº“çš„æ—¶å€™ï¼Œä½ å°±ä¸å¾—ä¸è€ƒè™‘å¦‚æœåœ¨Javaä¸­è°ƒç”¨Cåº“ä¸­çš„æ¥å£(dll, so)ã€‚è¿™æ ·çš„æƒ…å†µæœ‰å¾ˆå¤šï¼Œæ¯”å¦‚å½“ä½ éœ€è¦è®¿é—®ä¸€ä¸ªç¡¬ä»¶æ—¶ï¼Œè€Œç¡¬ä»¶å‚å•†åªæä¾›Cè¯­è¨€å†™çš„é©±åŠ¨å’Œåº“æ–‡ä»¶ã€‚

åˆšå¼€å§‹ï¼Œæˆ–è®¸åƒæˆ‘ä¸€æ ·ï¼Œå¤§éƒ¨åˆ†äººçŸ¥é“Javaæœ‰ä¸€ä¸ªå«JNIçš„ä¸œè¥¿å¯ä»¥åšåˆ°è¿™ä¸€ç‚¹ï¼Œè¿˜ä¸åä¸æ˜¯ä¹ˆï¼Œè‡³å°‘å¯ä»¥å®ç°å®ƒã€‚ä½†æ˜¯JNIçš„ç¼–å†™ç›¸å½“å¤æ‚å’Œæ‹™åŠ£ï¼Œå…³é”®çš„ä¸€ç‚¹æ˜¯éœ€è¦ç¼–å†™Cä»£ç ï¼Œè¦çŸ¥é“è¿™å¯¹äºç›¸å½“ä¸€éƒ¨åˆ†Javaç¨‹åºå‘˜æ¥è¯´å¯ä¸æ˜¯ä¸€ä¸ªå®¹æ˜“çš„äº‹æƒ…ã€‚é™¤äº†ä½ è¦ç²¾é€šCè¯­è¨€ï¼Œè¿˜è¦ç†Ÿæ‚‰JNIçš„çŸ¥è¯†ï¼ŒåŒ…æ‹¬Cçš„æ•°æ®ç±»å‹å¦‚ä½•å¯¹åº”åˆ°JNIçš„Cæ•°æ®ç±»å‹ï¼Œåˆå¦‚ä½•å¯¹åº”åˆ°Javaçš„æ•°æ®ç±»å‹ï¼Œè¿˜æœ‰å¾ˆå¤šå…¶ä»–çš„ç»†èŠ‚éœ€è¦æ³¨æ„ï¼Œæ¯”å¦‚åƒåœ¾å›æ”¶çš„é—®é¢˜ï¼Œè¿˜æœ‰ç»“æ„ä½“æ•°æ®ç±»å‹å¯¹åº”é—®é¢˜ï¼Œè·¨å¹³å°é—®é¢˜ç­‰ç­‰éƒ½è¶³ä»¥æŠŠä½ æå¾—å¤´å¤§ã€‚å¾ˆå¤šæƒ…å†µä¸‹ï¼Œåªä¸è¿‡æ˜¯ä¸ºäº†è°ƒç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“ï¼Œä¸å¾—ä¸å†é€ å‡ºè‡ªå·±çš„ä¸€ä¸ªåº“ï¼Œä¸å¾—ä¸ç¼–å†™JNIä»£ç å’Œæœ¬åœ°ä»£ç ã€‚æˆ‘ä¸ºä»€ä¹ˆä¸èƒ½ç›´æ¥è°ƒç”¨æœ¬åœ°åº“ä»£ç ?

ç›´åˆ°æœ‰é‚£ä¹ˆä¸€å¤©ï¼ŒæŸä¸ªäººå‘Šè¯‰ä½ æœ‰ä¸ªå«JNAçš„ä¸œè¥¿ï¼Œå°±æ˜¯ä¸“é—¨ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„ã€‚åƒä¸‹é¢è¿™ä¸ª<a title="JNA GettingStartted" href="https://github.com/twall/jna/blob/master/www/GettingStarted.md" target="_blank">ä¾‹å­</a>è¿™ä¹ˆç®€å•ã€‚

&nbsp;
<pre escaped="true" lang="java" line="1">package com.sun.jna.examples;

import com.sun.jna.Library;
import com.sun.jna.Native;
import com.sun.jna.Platform;

/** Simple example of JNA interface mapping and usage. */
public class HelloWorld {

// This is the standard, stable way of mapping, which supports extensive
// customization and mapping of Java to native types.

public interface CLibrary extends Library {
CLibrary INSTANCE = (CLibrary)
Native.loadLibrary((Platform.isWindows() ? "msvcrt" : "c"),
CLibrary.class);

void printf(String format, Object... args);
}

public static void main(String[] args) {
CLibrary.INSTANCE.printf("Hello, World\n");
for (int i=0;i &lt; args.length;i++) {
CLibrary.INSTANCE.printf("Argument %d: %s\n", i, args[i]);
}
}
}</pre>
&nbsp;

ä½¿ç”¨JNAï¼Œä½ ç”šè‡³ä¸éœ€è¦å¾ˆå¤šçš„æ–‡æ¡£ï¼Œåªè¦æ‹¿åˆ°ç¬¬ä¸‰æ–¹åº“çš„å¤´æ–‡ä»¶ï¼Œæ¯”å¦‚third.hï¼Œæ ¹æ®é‡Œé¢çš„å‡½æ•°å®šä¹‰ç›´æ¥ç”ŸæˆJavaçš„ä»£ç ï¼Œå‡ åˆ†é’Ÿå°±å¯ä»¥æå®šã€‚Javaå’Œæœ¬åœ°Cåº“çš„æ˜ å°„ï¼Œå¯ä»¥æ ¹æ®å¤´æ–‡ä»¶ç›´æ¥ç”Ÿæˆï¼Œç”šè‡³ä¸ç”¨å¼€å‘äººå‘˜æ‰‹åŠ¨ç¼–å†™å¯¹åº”å…³ç³»ã€‚è¦ç”¨å“ªå‡ ä¸ªå‡½æ•°ï¼Œå°±åœ¨Javaæ¥å£ä¸­æ·»åŠ å“ªå‡ ä¸ªå‡½æ•°ã€‚ä½ å¯ä»¥æŒ‰ç…§è‡ªå·±æƒ³è¦çš„æ–¹å¼åŠ è½½æœ¬åœ°åº“(å¦‚æœä½ æ›¾è¢«JNIä¸‹é¢System.loadLibraryé‚£æ‰æ‘¸ä¸å®šçš„java.library.pathæå¾—ç”Ÿä¸å¦‚æ­»)ï¼ŒJNAè¿˜å¯ä»¥åšåˆ°Cç»“æ„ä½“å’ŒJavaç±»çš„æ˜ å°„ï¼Œå¦‚æœä½ éœ€è¦åœ¨Javaä¸­ï¼Œå‘æœ¬åœ°æ–¹æ³•ä¼ é€’ç»“æ„ä½“ï¼Œè¿™å°±ä¼šå¾ˆæœ‰ç”¨:

&nbsp;
<pre escaped="true" lang="java" line="1">public static class SYSTEMTIME extends Structure {
public short wYear;
public short wMonth;
public short wDayOfWeek;
public short wDay;
public short wHour;
public short wMinute;
public short wSecond;
public short wMilliseconds;
}

void GetSystemTime(SYSTEMTIME result);</pre>
&nbsp;

ç›¸æ¯”è¾ƒä¸JNIæ¥è¯´ï¼ŒJNAä¹Ÿæœ‰å®ƒçš„ç¼ºç‚¹ï¼Œå…¶å®JNAæ˜¯å»ºç«‹ä¸JNIçš„åŸºç¡€ä¹‹ä¸Šçš„ï¼Œæ‰€ä»¥å¦‚æœå¯¹æ€§èƒ½è¦æ±‚ç‰¹åˆ«é«˜ï¼Œé‚£ä¹ˆå¤šèŠ±ç‚¹æ—¶é—´åœ¨JNIä¸Šé¢ä¹Ÿè®¸æ˜¯å€¼å¾—çš„ã€‚å¦å¤–ï¼ŒJNAåœ¨Javaè°ƒç”¨åº•å±‚Cåº“çš„æ—¶å€™ç‰¹åˆ«æ–¹ä¾¿ï¼Œä½†æ˜¯åè¿‡æ¥ï¼Œå¦‚æœæƒ³è¦ä»Cé‡Œé¢è°ƒç”¨Javaï¼ŒJNAå¯èƒ½ä¼šé‡åˆ°ä¸å°çš„éº»çƒ¦ï¼Œè¿™æ—¶å€™ä½ ä¹Ÿè®¸éœ€è¦è½¬å›åˆ°JNI.

å¦‚æœä½ è¿˜å¯¹Javaçš„Nativeå¼€å‘å¿ƒæœ‰ä½™æ‚¸ï¼Œå¸Œæœ›è¿™ç¯‡ä»‹ç»çš„JNAçš„æ–‡ç« å¯ä»¥å¸®åŠ©ä½ è·¨è¶ŠJNIå¼€å‘çš„è¿™é“é¸¿æ²Ÿ:)

    <hr>
    <div class="pagination">
      <ul>
      
        <li class="prev"><a href="/blog/2011/06/classloader-leak-protection-in-tomcat" title="ClassLoader Memory Leak: Detection and Protection in Tomcat">&larr; Previous</a></li>
      
        <li><a href="/archive.html">Archive</a></li>
      
        <li class="next"><a href="/blog/2011/07/java-dynamic-compilation" title="JDK1.4ä¸‹é¢å¦‚ä½•å®ç°Java SourceåŠ¨æ€ç¼–è¯‘åŠå…¶åº”ç”¨">Next &rarr;</a></li>
      
      </ul>
    </div>
    <hr>
    


  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_developer = 1;
    var disqus_shortname = 'hackfisher'; // required: replace example with your forum shortname
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>




  </div>
  
  <div class="span4">
    <h4>Published</h4>
    <div class="date"><span>30 June 2011</span></div>

  
    <h4>Tags</h4>
    <ul class="tag_box">
    
    


  
     
    	<li><a href="/tags.html#Java-ref">Java <span>9</span></a></li>
     
    	<li><a href="/tags.html#JNA-ref">JNA <span>1</span></a></li>
     
    	<li><a href="/tags.html#JNI-ref">JNI <span>1</span></a></li>
    
  



    </ul>
    
  </div>
</div>


		  </div>
    </div> <!-- /container -->

    


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30459154-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



    <!-- JiaThis Button BEGIN -->
<script type="text/javascript">var jiathis_config = {data_track_clickback:true};</script>
<script type="text/javascript" src="http://v3.jiathis.com/code/jiathis_r.js?move=0&amp;uid=1344392196475354" charset="utf-8"></script>
<!-- JiaThis Button END -->
	<a target="_blank" href="http://vps.42qu.com/by/10022683" style="background:url(http://css42.42qu.us/png/42_39.png) #fff no-repeat ; line-height: 0; display: inline-block; height: 39px; padding-left: 48px; color:#000; text-decoration: none;"><span style="clear:both;margin-bottom:32px;"><span style="font-family: Trebuchet MS; line-height: 18px;"><span style="font-weight: bold; color:#d20; font-size: 19px;">VPS.42QU.COM</span><span style="margin-left: 1px; display: block; font-size: 12px; line-height: 14px; font-weight: bolder; margin-top: 4px;">ºÃÖ÷»ú <span style="margin:0 2px">,</span> Âô¸ø´´ÒµµÄÄã</span></span></span></a>
  </body>
</html>

